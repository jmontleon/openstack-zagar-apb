FROM ansibleplaybookbundle/apb-base:canary
MAINTAINER Ansible Playbook Bundle Community

LABEL "com.redhat.apb.spec"=\
"LS0tCgp2ZXJzaW9uOiAxLjAKbmFtZTogb3BlbnN0YWNrLXphcWFyLWFwYgpkZXNjcmlwdGlvbjog\
IE9wZW5zdGFjayBaYXFhciBhcGIgaW1wbGVtZW50YXRpb24KYmluZGFibGU6IGZhbHNlCmFzeW5j\
OiBvcHRpb25hbAp0YWdzOgogIC0gcXVldWUKbWV0YWRhdGE6CiAgZG9jdW1lbnRhdGlvblVybDog\
aHR0cHM6Ly93aWtpLm9wZW5zdGFjay5vcmcvd2lraS9aYXFhciAKICBsb25nRGVzY3JpcHRpb246\
IEFuIGFwYiB0aGF0IGRlcGxveXMgYW4gb3BlbnN0YWNrIHphcWFyIHF1ZXVlCiAgZGlzcGxheU5h\
bWU6IE9wZW5zdGFjayBaYXFhciAoQVBCKQogIGNvbnNvbGUub3BlbnNoaWZ0LmlvL2ljb25DbGFz\
czogaWNvbi1vcGVuc3RhY2sKICBwcm92aWRlckRpc3BsYXlOYW1lOiAiUmVkIEhhdCwgSW5jLiIK\
cGxhbnM6CiAgLSBuYW1lOiBkZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogQSBzaW5nbGUgWmFxYXIg\
bWVzc2FnZSBxdWV1ZQogICAgZnJlZTogdHJ1ZQogICAgbWV0YWRhdGE6CiAgICAgIGRpc3BsYXlO\
YW1lOiBEZWZhdWx0CiAgICAgIGxvbmdEZXNjcmlwdGlvbjogVGhpcyBwbGFuIHByb3ZpZGVzIGEg\
c2luZ2xlIE9wZW5zdGFjayBaYXFhciBtZXNzYWdlIHF1ZXVlCiAgICAgIGNvc3Q6ICQwLjAwCiAg\
ICBwYXJhbWV0ZXJzOgogICAgICAtIG5hbWU6IHF1ZXVlX25hbWUKICAgICAgICB0eXBlOiBzdHJp\
bmcKICAgICAgICB0aXRsZTogUXVldWUgTmFtZQogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAg\
IC0gbmFtZTogdXNlcgogICAgICAgIHRpdGxlOiBVc2VyCiAgICAgICAgdHlwZTogc3RyaW5nCiAg\
ICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICBkaXNwbGF5X2dyb3VwOiAiT3BlbnN0YWNrIEF1\
dGhlbnRpY2F0aW9uIgogICAgICAtIG5hbWU6IHBhc3MKICAgICAgICB0eXBlOiBzdHJpbmcKICAg\
ICAgICB0aXRsZTogUGFzc3dvcmQKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIGRpc3Bs\
YXlfdHlwZTogcGFzc3dvcmQKICAgICAgICBkaXNwbGF5X2dyb3VwOiAiT3BlbnN0YWNrIEF1dGhl\
bnRpY2F0aW9uIgogICAgICAtIG5hbWU6IHByb2plY3QKICAgICAgICB0aXRsZTogUHJvamVjdAog\
ICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGlzcGxh\
eV9ncm91cDogIk9wZW5zdGFjayBBdXRoZW50aWNhdGlvbiIKICAgICAgLSBuYW1lOiB1cmwKICAg\
ICAgICB0aXRsZTogSWRlbnRpdHkgVVJMCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgcmVx\
dWlyZWQ6IHRydWUKICAgICAgICBkaXNwbGF5X2dyb3VwOiAiT3BlbnN0YWNrIEF1dGhlbnRpY2F0\
aW9uIgo="


RUN pip install shade

ADD playbooks /opt/apb/actions

# Add our role into the ansible roles dir
ADD . /opt/ansible/roles/openstack-zaqar-apb

RUN chmod -R g=u /opt/{ansible,apb}

USER apb
